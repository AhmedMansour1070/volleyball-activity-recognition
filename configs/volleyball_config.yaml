# Volleyball Dataset Configuration - Full Dataset with Improved Settings

# Dataset Configuration
dataset:
  name: "volleyball"
  root: "data/volleyball"
  
  # Temporal window configuration
  temporal_window:
    frames_before: 5
    frames_after: 4
    target_frame: true
  
  # Activity labels (8 classes)
  activity_labels:
    - "r_set"
    - "r_spike"
    - "r_pass"
    - "r_winpoint"
    - "l_winpoint"
    - "l_pass"
    - "l_spike"
    - "l_set"
  
  # Action labels (9 classes)
  action_labels:
    - "waiting"
    - "setting"
    - "digging"
    - "falling"
    - "spiking"
    - "blocking"
    - "jumping"
    - "moving"
    - "standing"
  
  # Official train/val/test splits for all 55 videos
  # Train: 24 videos
  train_videos: ["1", "3", "6", "7", "10", "13", "15", "16", "18", 
                 "22", "23", "31", "32", "36", "38", "39", "40", 
                 "41", "42", "48", "50", "52", "53", "54"]
  
  # Val: 15 videos
  val_videos: ["0", "2", "8", "12", "17", "19", "24", "26", 
               "27", "28", "30", "33", "46", "49", "51"]
  
  # Test: 16 videos
  test_videos: ["4", "5", "9", "11", "14", "20", "21", "25", 
                "29", "34", "35", "37", "43", "44", "45", "47"]

# Feature Extraction Configuration
feature_extraction:
  model_name: "alexnet"
  layer: "fc7"
  feature_dim: 9216
  image_size: 224
  batch_size: 32
  normalize_mean: [0.485, 0.456, 0.406]
  normalize_std: [0.229, 0.224, 0.225]

# Model Architecture
model:
  # Stage 1: Person LSTM
  person_lstm:
    input_dim: 9216
    hidden_dim: 3000
    num_layers: 1
    dropout: 0.5  # Increased from 0.3
    bidirectional: false
  
  # Stage 2: Group LSTM  
  group_lstm:
    input_dim: 12216  # 9216 (CNN) + 3000 (Person LSTM)
    hidden_dim: 500
    num_layers: 1
    dropout: 0.5  # Increased from 0.3
    bidirectional: false
  
  pooling: "max"
  num_action_classes: 9
  num_activity_classes: 8

# Training Configuration - IMPROVED SETTINGS
training:
  batch_size: 4  # Keep at 4 for stability
  num_epochs: 50
  
  # Optimizer settings - IMPROVED
  optimizer: "sgd"
  learning_rate: 0.0001  # INCREASED 10x from 0.00001 to 0.0001
  momentum: 0.9
  weight_decay: 0.001  # INCREASED 10x from 0.0001 to 0.001
  
  # Learning rate schedule
  lr_scheduler:
    type: "step"
    step_size: 20  # Reduced from 30 for more frequent updates
    gamma: 0.1
  
  # Early stopping
  early_stopping:
    enabled: true
    patience: 10  # Reduced from 15 for faster stopping
    min_delta: 0.001
  
  # Gradient clipping
  grad_clip: 5.0
  
  # Loss weights
  loss_weights:
    action_loss: 0.5
    activity_loss: 1.0
  
  use_class_weights: false
  focal_loss: false

# Hardware Configuration
hardware:
  device: "cuda"
  num_workers: 0  # Set to 0 for Windows
  pin_memory: true
  use_amp: false

# Logging Configuration
logging:
  log_dir: "outputs/logs"
  checkpoint_dir: "outputs/checkpoints"
  log_interval: 10
  save_interval: 5
  tensorboard: true

# Evaluation Configuration
evaluation:
  metrics:
    - "accuracy"
    - "precision"
    - "recall"
    - "f1"
    - "confusion_matrix"
  
  save_predictions: true
  save_confusion_matrix: true
  per_class_metrics: true

# Paths
paths:
  dataset_root: "data/volleyball"
  features_dir: "data/volleyball/features"
  outputs_dir: "outputs"
  cache_dir: "data/volleyball/cache"