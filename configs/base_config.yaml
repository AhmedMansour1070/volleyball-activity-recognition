# Volleyball Dataset Configuration

# Dataset Configuration
dataset:
  name: "volleyball"
  root: "data/volleyball"
  
  # Temporal window configuration
  # Each clip has 41 frames: 20 before target, target, 20 after
  # Paper uses: 5 before + target + 4 after = 10 frames total
  temporal_window:
    frames_before: 5      # Frames before target
    frames_after: 4       # Frames after target
    target_frame: true    # Include target frame
  
  # Activity labels (8 classes) - Group/Team activities
  activity_labels:
    - "r_set"           # Right team setting
    - "r_spike"         # Right team spiking
    - "r_pass"          # Right team passing
    - "r_winpoint"      # Right team winning point
    - "l_winpoint"      # Left team winning point
    - "l_pass"          # Left team passing
    - "l_spike"         # Left team spiking
    - "l_set"           # Left team setting
  
  # Action labels (9 classes) - Individual player actions
  action_labels:
    - "waiting"         # Player waiting
    - "setting"         # Player setting ball
    - "digging"         # Player digging ball
    - "falling"         # Player falling
    - "spiking"         # Player spiking
    - "blocking"        # Player blocking
    - "jumping"         # Player jumping
    - "moving"          # Player moving
    - "standing"        # Player standing (most common)
  
  # Train/Val/Test splits for 10 videos currently available
  # Update these when you have all 55 videos
  train_videos: ["1", "3", "6", "7"]      # 4 videos
  val_videos: ["0", "2", "8"]             # 3 videos
  test_videos: ["4", "5", "9"]            # 3 videos
  
  # Uncomment and use these when you have all 55 videos
  # train_videos: ["1", "3", "6", "7", "10", "13", "15", "16", "18", 
  #                "22", "23", "31", "32", "36", "38", "39", "40", 
  #                "41", "42", "48", "50", "52", "53", "54"]
  # val_videos: ["0", "2", "8", "12", "17", "19", "24", "26", 
  #              "27", "28", "30", "33", "46", "49", "51"]
  # test_videos: ["4", "5", "9", "11", "14", "20", "21", "25", 
  #               "29", "34", "35", "37", "43", "44", "45", "47"]

# Feature Extraction Configuration
feature_extraction:
  model_name: "alexnet"        # AlexNet (used in paper)
  layer: "fc7"                 # Feature layer
  feature_dim: 4096            # AlexNet fc7 dimension
  image_size: 224              # Input image size
  batch_size: 32               # Batch size for extraction
  
  # ImageNet normalization (standard)
  normalize_mean: [0.485, 0.456, 0.406]
  normalize_std: [0.229, 0.224, 0.225]

# Model Architecture
model:
  # Stage 1: Person LSTM
  person_lstm:
    input_dim: 4096           # AlexNet fc7 dimension
    hidden_dim: 3000          # As per paper
    num_layers: 1
    dropout: 0.3
    bidirectional: false
  
  # Stage 2: Group LSTM  
  group_lstm:
    input_dim: 7096           # 4096 (CNN) + 3000 (Person LSTM)
    hidden_dim: 500           # As per paper
    num_layers: 1
    dropout: 0.3
    bidirectional: false
  
  # Pooling strategy across players
  pooling: "max"              # max, avg, or attention
  
  # Number of classes
  num_action_classes: 9
  num_activity_classes: 8

# Training Configuration
training:
  # Basic settings
  batch_size: 8               # Adjust based on GPU memory
  num_epochs: 100
  
  # Optimizer (as per paper)
  optimizer: "sgd"
  learning_rate: 0.00001      # 1e-5 as per paper
  momentum: 0.9
  weight_decay: 0.0001
  
  # Learning rate schedule
  lr_scheduler:
    type: "step"
    step_size: 30
    gamma: 0.1
  
  # Early stopping
  early_stopping:
    enabled: true
    patience: 15
    min_delta: 0.001
  
  # Gradient clipping
  grad_clip: 5.0
  
  # Loss weights
  loss_weights:
    action_loss: 0.5          # Auxiliary task
    activity_loss: 1.0        # Main task
  
  # Class imbalance handling
  use_class_weights: false    # Set to true if needed
  focal_loss: false           # Alternative to class weights

# Hardware Configuration
hardware:
  device: "cuda"              # cuda or cpu
  num_workers: 4              # DataLoader workers
  pin_memory: true
  use_amp: false              # Automatic Mixed Precision

# Logging Configuration
logging:
  log_dir: "outputs/logs"
  checkpoint_dir: "outputs/checkpoints"
  log_interval: 10            # Log every N batches
  save_interval: 5            # Save checkpoint every N epochs
  tensorboard: true

# Evaluation Configuration
evaluation:
  metrics:
    - "accuracy"
    - "precision"
    - "recall"
    - "f1"
    - "confusion_matrix"
  
  save_predictions: true
  save_confusion_matrix: true
  per_class_metrics: true

# Paths
paths:
  dataset_root: "data/volleyball"
  features_dir: "data/volleyball/features"
  outputs_dir: "outputs"
  cache_dir: "data/volleyball/cache"